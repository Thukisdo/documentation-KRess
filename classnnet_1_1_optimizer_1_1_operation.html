<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kreps: nnet::Optimizer::Operation Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Kreps
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Breast cancer detection through machine learning</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classnnet_1_1_optimizer_1_1_operation.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classnnet_1_1_optimizer_1_1_operation-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">nnet::Optimizer::Operation Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>High level interface that wraps the <a class="el" href="classnnet_1_1_optimizer.html" title="Interface class for all optimizers.">Optimizer</a> and provides parallelism capabilities.  
 <a href="classnnet_1_1_optimizer_1_1_operation.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_optimizer_8hpp_source.html">Optimizer.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for nnet::Optimizer::Operation:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classnnet_1_1_optimizer_1_1_operation.png" usemap="#nnet::Optimizer::Operation_map" alt=""/>
  <map id="nnet::Optimizer::Operation_map" name="nnet::Optimizer::Operation_map">
<area href="classnnet_1_1_c_n_n_optimizer_1_1_operation.html" alt="nnet::CNNOptimizer::Operation" shape="rect" coords="0,56,205,80"/>
<area href="classnnet_1_1_m_l_p_optimizer_1_1_operation.html" title="A delegate class to run the Optimizer." alt="nnet::MLPOptimizer::Operation" shape="rect" coords="215,56,420,80"/>
<area href="classnnet_1_1_m_p_i_m_l_p_optimizer_1_1_operation.html" alt="nnet::MPIMLPOptimizer::Operation" shape="rect" coords="215,112,420,136"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7e35203a53c4b5d625bf09a897e973b8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnet_1_1_optimizer_1_1_operation.html#a7e35203a53c4b5d625bf09a897e973b8">operator()</a> (size_t thread_rank, const <a class="el" href="classmath_1_1cl_f_tensor.html">math::clFTensor</a> &amp;inputs, const <a class="el" href="classmath_1_1cl_f_tensor.html">math::clFTensor</a> &amp;targets, cl::CommandQueue queue)=0</td></tr>
<tr class="memdesc:a7e35203a53c4b5d625bf09a897e973b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the optimizer on some inputs, using the given device. This operation must be thread-safe and reentrant. If this operation is called multiple times in a row (or concurrently), it must sum any changes to the model until <a class="el" href="classnnet_1_1_optimizer_1_1_operation.html#a36161d7dfd7614352171a013c1b886fc" title="Update the model using the cached changes. This operation is guaranteed to be called a single time,...">updateModel()</a> is called.  <a href="classnnet_1_1_optimizer_1_1_operation.html#a7e35203a53c4b5d625bf09a897e973b8">More...</a><br /></td></tr>
<tr class="separator:a7e35203a53c4b5d625bf09a897e973b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a595e015a37d3325a53285c4a94f75232"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnet_1_1_optimizer_1_1_operation.html#a595e015a37d3325a53285c4a94f75232">reserveCaches</a> (size_t num_threads)=0</td></tr>
<tr class="memdesc:a595e015a37d3325a53285c4a94f75232"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of caches to reserve for this operation. This is used to reserve memory for each thread for local reduction. This value must be in the range [1, num_threads).  <a href="classnnet_1_1_optimizer_1_1_operation.html#a595e015a37d3325a53285c4a94f75232">More...</a><br /></td></tr>
<tr class="separator:a595e015a37d3325a53285c4a94f75232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36161d7dfd7614352171a013c1b886fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnnet_1_1_optimizer_1_1_operation.html#a36161d7dfd7614352171a013c1b886fc">updateModel</a> (cl::CommandQueue &amp;queue)</td></tr>
<tr class="memdesc:a36161d7dfd7614352171a013c1b886fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the model using the cached changes. This operation is guaranteed to be called a single time, at the end of the epoch.  <a href="classnnet_1_1_optimizer_1_1_operation.html#a36161d7dfd7614352171a013c1b886fc">More...</a><br /></td></tr>
<tr class="separator:a36161d7dfd7614352171a013c1b886fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>High level interface that wraps the <a class="el" href="classnnet_1_1_optimizer.html" title="Interface class for all optimizers.">Optimizer</a> and provides parallelism capabilities. </p>
<p>An optimizer operation receives some inputs, and runs the optimization algorithm on them. Any changes to the model must be cached. At the end of the training epoch, the optimizer operation shall be called to update the model using the cached changes.</p>
<p>Multiple thread must be able use the same optimizer operation concurrently, and the optimizer operation may be called multiple times in a row without an update.</p>
<p>The operation should apply all the changes that were cached since the last update. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a7e35203a53c4b5d625bf09a897e973b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e35203a53c4b5d625bf09a897e973b8">&#9670;&nbsp;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void nnet::Optimizer::Operation::operator() </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>thread_rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmath_1_1cl_f_tensor.html">math::clFTensor</a> &amp;&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmath_1_1cl_f_tensor.html">math::clFTensor</a> &amp;&#160;</td>
          <td class="paramname"><em>targets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cl::CommandQueue&#160;</td>
          <td class="paramname"><em>queue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run the optimizer on some inputs, using the given device. This operation must be thread-safe and reentrant. If this operation is called multiple times in a row (or concurrently), it must sum any changes to the model until <a class="el" href="classnnet_1_1_optimizer_1_1_operation.html#a36161d7dfd7614352171a013c1b886fc" title="Update the model using the cached changes. This operation is guaranteed to be called a single time,...">updateModel()</a> is called. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thread_rank</td><td>The rank of the thread that is calling this operation. Can be used to use different caches for different threads. Must be in the range [0, num_threads). </td></tr>
    <tr><td class="paramname">inputs</td><td>The input for this operation. </td></tr>
    <tr><td class="paramname">targets</td><td>The targets corresponding to the inputs. </td></tr>
    <tr><td class="paramname">batch_device</td><td>The device that must be used to run this operation. </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classnnet_1_1_m_l_p_optimizer_1_1_operation.html#a87b6300c6949aea909c21bf79f1cfbae">nnet::MLPOptimizer::Operation</a>, and <a class="el" href="classnnet_1_1_c_n_n_optimizer_1_1_operation.html#acf9bbaa8b6e07512c4efb669de977eb6">nnet::CNNOptimizer::Operation</a>.</p>

</div>
</div>
<a id="a595e015a37d3325a53285c4a94f75232"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a595e015a37d3325a53285c4a94f75232">&#9670;&nbsp;</a></span>reserveCaches()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void nnet::Optimizer::Operation::reserveCaches </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_threads</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of caches to reserve for this operation. This is used to reserve memory for each thread for local reduction. This value must be in the range [1, num_threads). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_threads</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classnnet_1_1_m_l_p_optimizer_1_1_operation.html#a747f3261ef0cd7f339c79cbfea9381fc">nnet::MLPOptimizer::Operation</a>, and <a class="el" href="classnnet_1_1_c_n_n_optimizer_1_1_operation.html#a664a91b8ffd91f7b9d2dace06af5d029">nnet::CNNOptimizer::Operation</a>.</p>

</div>
</div>
<a id="a36161d7dfd7614352171a013c1b886fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36161d7dfd7614352171a013c1b886fc">&#9670;&nbsp;</a></span>updateModel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void nnet::Optimizer::Operation::updateModel </td>
          <td>(</td>
          <td class="paramtype">cl::CommandQueue &amp;&#160;</td>
          <td class="paramname"><em>queue</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the model using the cached changes. This operation is guaranteed to be called a single time, at the end of the epoch. </p>
<p>When this method returns, the model update must be completely finished, and the optimizer operation must be ready to be called again. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">queue</td><td>The queue to use for the model update </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/thukisdo/Desktop/Cours/projet21/include/neuralNetwork/<a class="el" href="_optimizer_8hpp_source.html">Optimizer.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>nnet</b></li><li class="navelem"><a class="el" href="classnnet_1_1_optimizer.html">Optimizer</a></li><li class="navelem"><a class="el" href="classnnet_1_1_optimizer_1_1_operation.html">Operation</a></li>
    <li class="footer">Generated on Tue May 3 2022 15:23:03 for Kreps by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
